"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)};function t(e,t,n,r){return new(n||(n=Promise))((function(o,a){function p(e){try{i(r.next(e))}catch(e){a(e)}}function s(e){try{i(r.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(p,s)}i((r=r.apply(e,t||[])).next())}))}function n(e,t){var n,r,o,a,p={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(p=0)),p;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return p.label++,{value:s[1],done:!1};case 5:p.label++,r=s[1],s=[0];continue;case 7:s=p.ops.pop(),p.trys.pop();continue;default:if(!(o=p.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){p=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){p.label=s[1];break}if(6===s[0]&&p.label<o[1]){p.label=o[1],o=s;break}if(o&&p.label<o[2]){p.label=o[2],p.ops.push(s);break}o[2]&&p.ops.pop(),p.trys.pop();continue}s=t.call(e,p)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}function r(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function o(t,n,r){var o=function(e){var t={current:0,next:function(){return++this.current}},n={};return{add:function(r,o){var a=null!=o?o:"".concat(t.next(),"_").concat(e);return n[a]=r,a},resolve:function(e,t,r){var o=n[e];o&&(r(t)?o.resolve(t):o.reject(t),n[e]=null)}}}(r);return n((function(e){if(e.detail&&e.detail.data&&"object"==typeof e.detail.data&&"request_id"in e.detail.data){var t=e.detail.data,n=t.request_id,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["request_id"]);n&&o.resolve(n,r,(function(e){return!("error_type"in e)}))}})),function(n,r){return void 0===r&&(r={}),new Promise((function(a,p){var s=o.add({resolve:a,reject:p},r.request_id);t(n,e(e({},r),{request_id:s}))}))}}var a,p="undefined"!=typeof window,s=Boolean(p&&window.AndroidBridge),i=Boolean(p&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.VKWebAppClose),u=Boolean(p&&window.ReactNativeWebView&&"function"==typeof window.ReactNativeWebView.postMessage),c=p&&!s&&!i,d=c&&/(^\?|&)vk_platform=mobile_web(&|$)/.test(location.search),l=c?"message":"VKWebAppEvent",b=r(["VKWebAppInit","VKWebAppGetCommunityAuthToken","VKWebAppAddToCommunity","VKWebAppAddToHomeScreenInfo","VKWebAppClose","VKWebAppCopyText","VKWebAppCreateHash","VKWebAppGetUserInfo","VKWebAppSetLocation","VKWebAppSendToClient","VKWebAppGetClientVersion","VKWebAppGetPhoneNumber","VKWebAppGetEmail","VKWebAppGetGroupInfo","VKWebAppGetGeodata","VKWebAppGetCommunityToken","VKWebAppGetConfig","VKWebAppGetLaunchParams","VKWebAppSetTitle","VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppJoinGroup","VKWebAppLeaveGroup","VKWebAppAllowMessagesFromGroup","VKWebAppDenyNotifications","VKWebAppAllowNotifications","VKWebAppOpenPayForm","VKWebAppOpenApp","VKWebAppShare","VKWebAppShowWallPostBox","VKWebAppScroll","VKWebAppShowOrderBox","VKWebAppShowLeaderBoardBox","VKWebAppShowInviteBox","VKWebAppShowRequestBox","VKWebAppAddToFavorites","VKWebAppShowStoryBox","VKWebAppStorageGet","VKWebAppStorageGetKeys","VKWebAppStorageSet","VKWebAppFlashGetInfo","VKWebAppSubscribeStoryApp","VKWebAppOpenWallPost","VKWebAppCheckAllowedScopes","VKWebAppCheckBannerAd","VKWebAppHideBannerAd","VKWebAppShowBannerAd","VKWebAppCheckNativeAds","VKWebAppShowNativeAds","VKWebAppRetargetingPixel","VKWebAppConversionHit","VKWebAppShowSubscriptionBox","VKWebAppCheckSurvey","VKWebAppShowSurvey","VKWebAppScrollTop","VKWebAppScrollTopStart","VKWebAppScrollTopStop","VKWebAppShowSlidesSheet","VKWebAppTranslate","VKWebAppRecommend","VKWebAppAddToProfile","VKWebAppGetFriends"],c&&!d?["VKWebAppResizeWindow","VKWebAppAddToMenu","VKWebAppShowInstallPushBox","VKWebAppShowCommunityWidgetPreviewBox","VKWebAppCallStart","VKWebAppCallJoin","VKWebAppCallGetStatus"]:["VKWebAppShowImages"],!0),f=p?window.AndroidBridge:void 0,A=i?window.webkit.messageHandlers:void 0,v=c?parent:void 0;var h,m,w,W,V,K,_,y,g,E;exports.EAdsFormats=void 0,(h=exports.EAdsFormats||(exports.EAdsFormats={})).REWARD="reward",h.INTERSTITIAL="interstitial",exports.BannerAdLayoutType=void 0,(m=exports.BannerAdLayoutType||(exports.BannerAdLayoutType={})).RESIZE="resize",m.OVERLAY="overlay",exports.BannerAdLocation=void 0,(w=exports.BannerAdLocation||(exports.BannerAdLocation={})).TOP="top",w.BOTTOM="bottom",exports.BannerAdAlign=void 0,(W=exports.BannerAdAlign||(exports.BannerAdAlign={})).LEFT="left",W.RIGHT="right",W.CENTER="center",exports.BannerAdHeightType=void 0,(V=exports.BannerAdHeightType||(exports.BannerAdHeightType={})).COMPACT="compact",V.REGULAR="regular",exports.BannerAdOrientation=void 0,(K=exports.BannerAdOrientation||(exports.BannerAdOrientation={})).HORIZONTAL="horizontal",K.VERTICAL="vertical",exports.EGrantedPermission=void 0,(_=exports.EGrantedPermission||(exports.EGrantedPermission={})).CAMERA="camera",_.LOCATION="location",_.PHOTO="photo",exports.EGetLaunchParamsResponseLanguages=void 0,(y=exports.EGetLaunchParamsResponseLanguages||(exports.EGetLaunchParamsResponseLanguages={})).RU="ru",y.UK="uk",y.UA="ua",y.EN="en",y.BE="be",y.KZ="kz",y.PT="pt",y.ES="es",exports.EGetLaunchParamsResponseGroupRole=void 0,(g=exports.EGetLaunchParamsResponseGroupRole||(exports.EGetLaunchParamsResponseGroupRole={})).ADMIN="admin",g.EDITOR="editor",g.MEMBER="member",g.MODER="moder",g.NONE="none",exports.EGetLaunchParamsResponsePlatforms=void 0,(E=exports.EGetLaunchParamsResponsePlatforms||(exports.EGetLaunchParamsResponsePlatforms={})).DESKTOP_WEB="desktop_web",E.DESKTOP_WEB_MESSENGER="desktop_web_messenger",E.DESKTOP_APP_MESSENGER="desktop_app_messenger",E.MOBILE_WEB="mobile_web",E.MOBILE_ANDROID="mobile_android",E.MOBILE_ANDROID_MESSENGER="mobile_android_messenger",E.MOBILE_IPHONE="mobile_iphone",E.MOBILE_IPHONE_MESSENGER="mobile_iphone_messenger",E.MOBILE_IPAD="mobile_ipad";var S=function(e){var p=void 0,d=[],h=Math.random().toString(36).substring(2,5);function m(e){d.push(e)}function w(e){return console.warn("This method is deprecated. Use supportsAsync instead."),s?!(!f||"function"!=typeof f[e]):i?!(!A||!A[e]||"function"!=typeof A[e].postMessage):!!c&&b.includes(e)}function W(){return i||s}function V(){return c&&window.parent!==window}function K(){return W()||V()}function _(e){if(i||s)return r([],d,!0).map((function(t){return t.call(null,e)}));var t=null==e?void 0:e.data;if(c&&t){if(u&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){}var n=t.type,o=t.data,a=t.frameId;n&&("VKWebAppSettings"!==n?r([],d,!0).map((function(e){return e({detail:{type:n,data:o}})})):p=a)}}u&&/(android)/i.test(navigator.userAgent)?document.addEventListener(l,_):"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener(l,_);var y=o((function(t,n){f&&f[t]?f[t](JSON.stringify(n)):A&&A[t]&&"function"==typeof A[t].postMessage?A[t].postMessage(n):u?window.ReactNativeWebView.postMessage(JSON.stringify({handler:t,params:n})):v&&"function"==typeof v.postMessage&&v.postMessage({handler:t,params:n,type:"vk-connect",webFrameId:p,connectVersion:e},"*")}),m,h);return m((function(e){if(e.detail&&"SetSupportedHandlers"===e.detail.type)a=e.detail.data.supportedHandlers})),{send:y,sendPromise:y,subscribe:m,unsubscribe:function(e){var t=d.indexOf(e);t>-1&&d.splice(t,1)},supports:w,supportsAsync:function(e){return t(this,void 0,void 0,(function(){var t;return n(this,(function(n){switch(n.label){case 0:if(s||i)return[2,w(e)];if(a)return[2,a.includes(e)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y("SetSupportedHandlers")];case 2:return t=n.sent(),[2,(a=t.supportedHandlers).includes(e)];case 3:return n.sent(),[2,(a=["VKWebAppInit"]).includes(e)];case 4:return[2]}}))}))},isWebView:W,isIframe:V,isEmbedded:K,isStandalone:function(){return!K()}}}("2.15.1");exports.applyMiddleware=function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.includes(void 0)||n.includes(null)?t.apply(void 0,n.filter((function(e){return"function"==typeof e}))):function(t){if(0===n.length)return t;var r,o={subscribe:t.subscribe,send:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.send.apply(t,e)}},a=n.filter((function(e){return"function"==typeof e})).map((function(e){return e(o)})).reduce((function(e,t){return function(n){return e(t(n))}}));return r=a(t.send),e(e({},t),{send:r})}},exports.default=S,exports.parseURLSearchParamsForGetLaunchParams=function(e){var t={};try{var n=new URLSearchParams(e);n.forEach((function(e,n){switch(n){case"vk_ts":case"vk_is_recommended":case"vk_profile_id":case"vk_has_profile_button":case"vk_testing_group_id":case"vk_user_id":case"vk_app_id":case"vk_group_id":t[n]=Number(e);break;case"sign":case"vk_chat_id":case"vk_ref":case"vk_access_token_settings":t[n]=e;break;case"odr_enabled":t.odr_enabled="1"===e?1:void 0;break;case"vk_is_app_user":case"vk_are_notifications_enabled":case"vk_is_favorite":t[n]=function(e){switch(e){case"0":return 0;case"1":return 1;default:return}}(e);break;case"vk_language":t.vk_language=function(e){return Object.values(exports.EGetLaunchParamsResponseLanguages).some((function(t){return t===e}))}(e)?e:void 0;break;case"vk_viewer_group_role":t.vk_viewer_group_role=function(e){return Object.values(exports.EGetLaunchParamsResponseGroupRole).some((function(t){return t===e}))}(e)?e:void 0;break;case"vk_platform":t.vk_platform=function(e){return Object.values(exports.EGetLaunchParamsResponsePlatforms).some((function(t){return t===e}))}(e)?e:void 0}}))}catch(e){console.warn(e)}return t};
//# sourceMappingURL=index.js.map
