{"version":3,"sources":["../../../../../src/raster/components/RasterIcon/RasterIcon.tsx"],"sourcesContent":["import React from 'react';\nimport {\n  appearanceTypes,\n  useIconAppearance,\n} from '../IconAppearanceProvider/IconAppearanceProvider';\nimport type { DensityBucketAppearanceSet, DensityBucketType } from './types';\nimport { getDensityBucketAppearanceKey } from './utils/getDensityBucketAppearanceKey';\n\ninterface RasterIconBaseProps extends React.ImgHTMLAttributes<HTMLImageElement> {\n  getRootRef?: React.Ref<HTMLImageElement>;\n}\n\ninterface RasterIconInternalProps extends DensityBucketAppearanceSet {\n  id: string;\n  size: number;\n}\n\ntype RasterIconProps = RasterIconInternalProps & RasterIconBaseProps;\n\n// https://developer.android.com/training/multiscreen/screendensities#TaskProvideAltBmp\nconst dppxModifiersMap: Record<DensityBucketType, number> = {\n  mdpi: 1,\n  hdpi: 1.5,\n  // Должно быть 2, но так как мы пропускаем при генерации hdpi, понижаем это значение.\n  // Считаем избыточным генерацию hdpi, xhdpi в использовании для hdpi не сильно шакалится.\n  xhdpi: 1.5,\n  xxhdpi: 3,\n  xxxhdpi: 4,\n};\n\nconst densityBucketTypes = Object.keys(dppxModifiersMap) as DensityBucketType[];\n\nconst RasterIcon = React.memo(function RasterIcon({\n  getRootRef,\n  id,\n  size,\n  className,\n  ...restProps\n}: RasterIconProps) {\n  const appearance = useIconAppearance();\n\n  const srcSet = densityBucketTypes\n    .reduce<string[]>((set, densityBucket) => {\n      const densityAppearanceKey = getDensityBucketAppearanceKey(appearance, densityBucket);\n      let src = restProps[densityAppearanceKey];\n      delete restProps[densityAppearanceKey];\n\n      for (const appearance of appearanceTypes) {\n        const densityAppearanceKey = getDensityBucketAppearanceKey(appearance, densityBucket);\n        if (!src) {\n          src = restProps[densityAppearanceKey];\n        }\n\n        delete restProps[densityAppearanceKey];\n      }\n\n      if (src) {\n        set.push(`${src} ${dppxModifiersMap[densityBucket]}x`);\n      }\n\n      return set;\n    }, [])\n    .join(', ');\n\n  return (\n    <img\n      ref={getRootRef}\n      aria-hidden=\"true\"\n      alt=\"\"\n      className={[\n        'vkuiIcon',\n        `vkuiIcon--${size}`,\n        `vkuiIcon--w-${size}`,\n        `vkuiIcon--h-${size}`,\n        `vkuiIcon--${id}`,\n        'vkuiRasterIcon',\n        className,\n      ]\n        .join(' ')\n        .trim()}\n      width={size}\n      height={size}\n      srcSet={srcSet}\n      loading=\"lazy\"\n      draggable={false}\n      {...restProps}\n    />\n  );\n});\n\nexport function makeRasterIcon<Props extends RasterIconBaseProps>(\n  componentName: string,\n  id: string,\n  size: number,\n  densityBucketAppearanceSet: DensityBucketAppearanceSet,\n): React.FC<Props> {\n  const Icon = (props: Props): JSX.Element => {\n    return <RasterIcon id={id} size={size} {...densityBucketAppearanceSet} {...props} />;\n  };\n\n  Icon.size = size;\n  Icon.isRasterIcon = true;\n  Icon.displayName = componentName;\n\n  return Icon;\n}\n"],"names":["makeRasterIcon","dppxModifiersMap","mdpi","hdpi","xhdpi","xxhdpi","xxxhdpi","densityBucketTypes","Object","keys","RasterIcon","React","memo","getRootRef","id","size","className","restProps","appearance","useIconAppearance","srcSet","reduce","set","densityBucket","densityAppearanceKey","getDensityBucketAppearanceKey","src","appearanceTypes","push","join","img","ref","aria-hidden","alt","trim","width","height","loading","draggable","componentName","densityBucketAppearanceSet","Icon","props","isRasterIcon","displayName"],"mappings":";;;;+BA0FgBA;;;eAAAA;;;;;;gDA1FE;sCAIX;6CAEuC;AAa9C,uFAAuF;AACvF,IAAMC,mBAAsD;IAC1DC,MAAM;IACNC,MAAM;IACN,qFAAqF;IACrF,yFAAyF;IACzFC,OAAO;IACPC,QAAQ;IACRC,SAAS;AACX;AAEA,IAAMC,qBAAqBC,OAAOC,IAAI,CAACR;AAEvC,IAAMS,2BAAaC,cAAK,CAACC,IAAI,CAAC,SAASF,WAAW;QAChDG,aADgD,OAChDA,YACAC,KAFgD,OAEhDA,IACAC,OAHgD,OAGhDA,MACAC,YAJgD,OAIhDA,WACGC,yCAL6C;QAChDJ;QACAC;QACAC;QACAC;;IAGA,IAAME,aAAaC,IAAAA,yCAAiB;IAEpC,IAAMC,SAASb,mBACZc,MAAM,CAAW,SAACC,KAAKC;QACtB,IAAMC,uBAAuBC,IAAAA,4DAA6B,EAACP,YAAYK;QACvE,IAAIG,MAAMT,SAAS,CAACO,qBAAqB;QACzC,OAAOP,SAAS,CAACO,qBAAqB;YAEjC,kCAAA,2BAAA;;YAAL,QAAK,YAAoBG,uCAAe,qBAAnC,SAAA,6BAAA,QAAA,yBAAA,iCAAqC;gBAArC,IAAMT,cAAN;gBACH,IAAMM,wBAAuBC,IAAAA,4DAA6B,EAACP,aAAYK;gBACvE,IAAI,CAACG,KAAK;oBACRA,MAAMT,SAAS,CAACO,sBAAqB;gBACvC;gBAEA,OAAOP,SAAS,CAACO,sBAAqB;YACxC;;YAPK;YAAA;;;qBAAA,6BAAA;oBAAA;;;oBAAA;0BAAA;;;;QASL,IAAIE,KAAK;YACPJ,IAAIM,IAAI,CAAC,AAAC,GAAS3B,OAAPyB,KAAI,KAAmC,OAAhCzB,gBAAgB,CAACsB,cAAc,EAAC;QACrD;QAEA,OAAOD;IACT,GAAG,EAAE,EACJO,IAAI,CAAC;IAER,qBACE,6BAACC;QACCC,KAAKlB;QACLmB,eAAY;QACZC,KAAI;QACJjB,WAAW;YACT;YACC,aAAiB,OAALD;YACZ,eAAmB,OAALA;YACd,eAAmB,OAALA;YACd,aAAe,OAAHD;YACb;YACAE;SACD,CACEa,IAAI,CAAC,KACLK,IAAI;QACPC,OAAOpB;QACPqB,QAAQrB;QACRK,QAAQA;QACRiB,SAAQ;QACRC,WAAW;OACPrB;AAGV;AAEO,SAASjB,eACduC,aAAqB,EACrBzB,EAAU,EACVC,IAAY,EACZyB,0BAAsD;IAEtD,IAAMC,OAAO,SAACC;QACZ,qBAAO,6BAAChC;YAAWI,IAAIA;YAAIC,MAAMA;WAAUyB,4BAAgCE;IAC7E;IAEAD,KAAK1B,IAAI,GAAGA;IACZ0B,KAAKE,YAAY,GAAG;IACpBF,KAAKG,WAAW,GAAGL;IAEnB,OAAOE;AACT"}