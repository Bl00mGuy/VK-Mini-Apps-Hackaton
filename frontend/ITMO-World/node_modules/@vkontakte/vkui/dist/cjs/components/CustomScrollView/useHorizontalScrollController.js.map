{"version":3,"sources":["../../../../src/components/CustomScrollView/useHorizontalScrollController.tsx"],"sourcesContent":["import * as React from 'react';\nimport type { CustomScrollBarController } from './types';\nimport { useTrackerVisibility } from './useTrackerVisibility';\n\nexport const useHorizontalScrollController = (\n  boxRef: React.RefObject<HTMLDivElement | null>,\n  autoHideScrollbar: boolean,\n  autoHideScrollbarDelay?: number,\n): CustomScrollBarController => {\n  const barX = React.useRef<HTMLDivElement>(null);\n\n  const horizontalRatio = React.useRef(NaN);\n  const lastTrackerLeft = React.useRef(0);\n  const clientWidth = React.useRef(0);\n  const trackerWidth = React.useRef(0);\n  const scrollWidth = React.useRef(0);\n  const startX = React.useRef(0);\n  const trackerLeft = React.useRef(0);\n\n  const trackerX = React.useRef<HTMLDivElement>(null);\n\n  const {\n    trackerVisible,\n    onTargetScroll,\n    onTrackerDragStart,\n    onTrackerDragStop,\n    onTrackerMouseEnter,\n    onTrackerMouseLeave,\n  } = useTrackerVisibility(autoHideScrollbar, autoHideScrollbarDelay);\n\n  const setHorizontalTrackerPosition = (scrollLeft: number) => {\n    lastTrackerLeft.current = scrollLeft;\n    if (trackerX.current !== null) {\n      trackerX.current.style.transform = `translate(${scrollLeft}px, 0)`;\n    }\n  };\n\n  const setTrackerPositionFromScroll = (scrollLeft: number) => {\n    const progress = scrollLeft / (scrollWidth.current - clientWidth.current);\n    setHorizontalTrackerPosition((clientWidth.current - trackerWidth.current) * progress);\n  };\n\n  const resize = () => {\n    if (!boxRef.current || !barX.current || !trackerX.current) {\n      return;\n    }\n    const localClientWidth = boxRef.current.clientWidth;\n    const localScrollWidth = boxRef.current.scrollWidth;\n    const localVerticalRatio = localClientWidth / localScrollWidth;\n    const localTrackerWidth = Math.max(localClientWidth * localVerticalRatio, 40);\n\n    horizontalRatio.current = localVerticalRatio;\n    clientWidth.current = localClientWidth;\n    scrollWidth.current = localScrollWidth;\n    trackerWidth.current = localTrackerWidth;\n    const currentScrollLeft = boxRef.current.scrollLeft;\n\n    if (localVerticalRatio >= 1) {\n      barX.current.style.display = 'none';\n    } else {\n      barX.current.style.display = '';\n      trackerX.current.style.width = `${localTrackerWidth}px`;\n      setTrackerPositionFromScroll(currentScrollLeft);\n    }\n  };\n\n  const setScrollPositionFromTracker = (trackerLeft: number) => {\n    const progress = trackerLeft / (clientWidth.current - trackerWidth.current);\n    if (boxRef.current !== null) {\n      boxRef.current.scroll({\n        left: (scrollWidth.current - clientWidth.current) * progress,\n      });\n    }\n  };\n\n  const dragging = (e: React.MouseEvent) => {\n    const diff = e.clientX - startX.current;\n    const position = Math.min(\n      Math.max(trackerLeft.current + diff, 0),\n      clientWidth.current - trackerWidth.current,\n    );\n    setScrollPositionFromTracker(position);\n  };\n\n  const dragEnd = () => {\n    if (autoHideScrollbar) {\n      onTrackerDragStop();\n    }\n  };\n\n  const scroll = () => {\n    if (!boxRef.current) {\n      return;\n    }\n    if (autoHideScrollbar) {\n      onTargetScroll();\n    }\n    setTrackerPositionFromScroll(boxRef.current.scrollLeft);\n  };\n\n  const dragStart = (e: React.MouseEvent) => {\n    startX.current = e.clientX;\n    trackerLeft.current = lastTrackerLeft.current;\n\n    if (autoHideScrollbar) {\n      onTrackerDragStart();\n    }\n  };\n\n  return {\n    barRef: barX,\n    trackerVisible,\n    trackerRef: trackerX,\n    resize,\n    dragging,\n    dragEnd,\n    scroll,\n    dragStart,\n    trackerMouseEnter: onTrackerMouseEnter,\n    trackerMouseLeave: onTrackerMouseLeave,\n  };\n};\n"],"names":["useHorizontalScrollController","boxRef","autoHideScrollbar","autoHideScrollbarDelay","barX","React","useRef","horizontalRatio","NaN","lastTrackerLeft","clientWidth","trackerWidth","scrollWidth","startX","trackerLeft","trackerX","trackerVisible","onTargetScroll","onTrackerDragStart","onTrackerDragStop","onTrackerMouseEnter","onTrackerMouseLeave","useTrackerVisibility","setHorizontalTrackerPosition","scrollLeft","current","style","transform","setTrackerPositionFromScroll","progress","resize","localClientWidth","localScrollWidth","localVerticalRatio","localTrackerWidth","Math","max","currentScrollLeft","display","width","setScrollPositionFromTracker","scroll","left","dragging","e","diff","clientX","position","min","dragEnd","dragStart","barRef","trackerRef","trackerMouseEnter","trackerMouseLeave"],"mappings":"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"}