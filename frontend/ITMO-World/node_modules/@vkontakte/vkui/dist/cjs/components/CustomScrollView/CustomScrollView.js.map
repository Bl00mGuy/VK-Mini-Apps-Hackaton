{"version":3,"sources":["../../../../src/components/CustomScrollView/CustomScrollView.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport type { HasRootRef } from '../../types';\nimport { ScrollX } from './ScrollX';\nimport { ScrollY } from './ScrollY';\nimport { type BarHandlers } from './types';\nimport { useCustomScrollViewResize } from './useCustomScrollViewResize';\nimport { useDetectScrollDirection } from './useDetectScrollDirection';\nimport { type TrackerOptionsProps } from './useTrackerVisibility';\nimport styles from './CustomScrollView.module.css';\n\nfunction hasPointerClassName(hasPointer: boolean | undefined) {\n  switch (hasPointer) {\n    case true:\n      return styles['CustomScrollView--hasPointer-true'];\n    case false:\n      return styles['CustomScrollView--hasPointer-false'];\n    case undefined:\n    default:\n      return styles['CustomScrollView--hasPointer-none'];\n  }\n}\n\nconst overscrollBehaviorClassNames = {\n  auto: undefined,\n  contain: styles['CustomScrollView__box--overscrollBehavior-contain'],\n  none: styles['CustomScrollView__box--overscrollBehavior-none'],\n};\n\nexport interface CustomScrollViewProps\n  extends React.AllHTMLAttributes<HTMLDivElement>,\n    HasRootRef<HTMLDivElement>,\n    TrackerOptionsProps {\n  windowResize?: boolean;\n  boxRef?: React.Ref<HTMLDivElement>;\n  className?: HTMLDivElement['className'];\n  onScroll?: (event: React.UIEvent<HTMLDivElement>) => void;\n  children: React.ReactNode;\n  /**\n   * Поведение overscroll, подробнее можно почитать в [документации](https://developer.mozilla.org/en-US/docs/Web/CSS/overscroll-behavior)\n   */\n  overscrollBehavior?: 'auto' | 'contain' | 'none';\n  /**\n   * Включение замены горизонтального скролла\n   *\n   * > ⚠️ Важно: На версиях Firefox ниже 64 могут возникнуть проблемы при использовании этого флага, будьте осторожны\n   */\n  enableHorizontalScroll?: boolean;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/CustomScrollView\n */\nexport const CustomScrollView = ({\n  className,\n  children,\n  boxRef: externalBoxRef,\n  windowResize,\n  autoHideScrollbar = false,\n  autoHideScrollbarDelay,\n  enableHorizontalScroll = false,\n  onScroll: onScrollProp,\n  getRootRef,\n  overscrollBehavior = 'auto',\n  ...restProps\n}: CustomScrollViewProps): React.ReactNode => {\n  const { hasPointer } = useAdaptivity();\n\n  const boxRef = useExternRef(externalBoxRef);\n  const boxContentRef = React.useRef<HTMLDivElement>(null);\n\n  const detectScrollDirection = useDetectScrollDirection();\n\n  const barYHandlers = React.useRef<BarHandlers | null>(null);\n  const barXHandlers = React.useRef<BarHandlers | null>(null);\n\n  useCustomScrollViewResize({\n    windowResize,\n    boxContentRef,\n    onResize: () => {\n      barYHandlers.current?.resize();\n      barXHandlers.current?.resize();\n    },\n  });\n\n  const onScroll = (event: React.UIEvent<HTMLDivElement>) => {\n    const scrollDirection = detectScrollDirection(event);\n    switch (scrollDirection) {\n      case 'horizontal':\n        barXHandlers.current?.scroll();\n        break;\n      case 'vertical':\n        barYHandlers.current?.scroll();\n        break;\n    }\n    onScrollProp?.(event);\n  };\n\n  return (\n    <div\n      className={classNames(className, styles['CustomScrollView'], hasPointerClassName(hasPointer))}\n      ref={getRootRef}\n      {...restProps}\n    >\n      <div\n        className={classNames(\n          styles['CustomScrollView__box'],\n          enableHorizontalScroll && styles['CustomScrollView__box--horizontalEnabled'],\n          overscrollBehaviorClassNames[overscrollBehavior],\n        )}\n        tabIndex={-1}\n        ref={boxRef}\n        onScroll={onScroll}\n      >\n        <div ref={boxContentRef} className={styles['CustomScrollView__box-content']}>\n          {children}\n        </div>\n      </div>\n      <ScrollY\n        barHandlers={barYHandlers}\n        boxRef={boxRef}\n        autoHideScrollbar={autoHideScrollbar}\n        autoHideScrollbarDelay={autoHideScrollbarDelay}\n      />\n      {enableHorizontalScroll && (\n        <ScrollX\n          barHandlers={barXHandlers}\n          boxRef={boxRef}\n          autoHideScrollbar={autoHideScrollbar}\n          autoHideScrollbarDelay={autoHideScrollbarDelay}\n        />\n      )}\n    </div>\n  );\n};\n"],"names":["CustomScrollView","hasPointerClassName","hasPointer","undefined","overscrollBehaviorClassNames","auto","contain","none","className","children","boxRef","externalBoxRef","windowResize","autoHideScrollbar","autoHideScrollbarDelay","enableHorizontalScroll","onScroll","onScrollProp","getRootRef","overscrollBehavior","restProps","useAdaptivity","useExternRef","boxContentRef","React","useRef","detectScrollDirection","useDetectScrollDirection","barYHandlers","barXHandlers","useCustomScrollViewResize","onResize","current","resize","event","scrollDirection","scroll","div","classNames","ref","tabIndex","ScrollY","barHandlers","ScrollX"],"mappings":";;;;+BAuDaA;;;eAAAA;;;;;;;;iEAvDU;sBACI;+BACG;8BACD;yBAEL;yBACA;2CAEkB;0CACD;AAIzC,SAASC,oBAAoBC,UAA+B;IAC1D,OAAQA;QACN,KAAK;YACH;QACF,KAAK;YACH;QACF,KAAKC;QACL;YACE;IACJ;AACF;AAEA,MAAMC,+BAA+B;IACnCC,MAAMF;IACNG,OAAO;IACPC,IAAI;AACN;AA0BO,MAAMP,mBAAmB;QAAC,EAC/BQ,SAAS,EACTC,QAAQ,EACRC,QAAQC,cAAc,EACtBC,YAAY,EACZC,oBAAoB,KAAK,EACzBC,sBAAsB,EACtBC,yBAAyB,KAAK,EAC9BC,UAAUC,YAAY,EACtBC,UAAU,EACVC,qBAAqB,MAAM,EAEL,WADnBC;QAVHZ;QACAC;QACAC;QACAE;QACAC;QACAC;QACAC;QACAC;QACAE;QACAC;;IAGA,MAAM,EAAEjB,UAAU,EAAE,GAAGmB,IAAAA,4BAAa;IAEpC,MAAMX,SAASY,IAAAA,0BAAY,EAACX;IAC5B,MAAMY,gBAAgBC,OAAMC,MAAM,CAAiB;IAEnD,MAAMC,wBAAwBC,IAAAA,kDAAwB;IAEtD,MAAMC,eAAeJ,OAAMC,MAAM,CAAqB;IACtD,MAAMI,eAAeL,OAAMC,MAAM,CAAqB;IAEtDK,IAAAA,oDAAyB,EAAC;QACxBlB;QACAW;QACAQ,UAAU;gBACRH,uBACAC;aADAD,wBAAAA,aAAaI,OAAO,cAApBJ,4CAAAA,sBAAsBK,MAAM;aAC5BJ,wBAAAA,aAAaG,OAAO,cAApBH,4CAAAA,sBAAsBI,MAAM;QAC9B;IACF;IAEA,MAAMjB,WAAW,CAACkB;QAChB,MAAMC,kBAAkBT,sBAAsBQ;QAC9C,OAAQC;YACN,KAAK;oBACHN;iBAAAA,wBAAAA,aAAaG,OAAO,cAApBH,4CAAAA,sBAAsBO,MAAM;gBAC5B;YACF,KAAK;oBACHR;iBAAAA,wBAAAA,aAAaI,OAAO,cAApBJ,4CAAAA,sBAAsBQ,MAAM;gBAC5B;QACJ;QACAnB,yBAAAA,mCAAAA,aAAeiB;IACjB;IAEA,qBACE,sBAACG;QACC7B,WAAW8B,IAAAA,gBAAU,EAAC9B,mCAAuCP,oBAAoBC;QACjFqC,KAAKrB;OACDE;;0BAEJ,qBAACiB;gBACC7B,WAAW8B,IAAAA,gBAAU,+BAEnBvB,0EACAX,4BAA4B,CAACe,mBAAmB;gBAElDqB,UAAU,CAAC;gBACXD,KAAK7B;gBACLM,UAAUA;0BAEV,cAAA,qBAACqB;oBAAIE,KAAKhB;oBAAef,SAAS;8BAC/BC;;;0BAGL,qBAACgC,gBAAO;gBACNC,aAAad;gBACblB,QAAQA;gBACRG,mBAAmBA;gBACnBC,wBAAwBA;;YAEzBC,wCACC,qBAAC4B,gBAAO;gBACND,aAAab;gBACbnB,QAAQA;gBACRG,mBAAmBA;gBACnBC,wBAAwBA;;;;AAKlC"}