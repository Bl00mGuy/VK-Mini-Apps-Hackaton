{"version":3,"sources":["../../../src/lib/utils.ts"],"sourcesContent":["import * as React from 'react';\nimport { shouldTriggerClickOnEnterOrSpace } from './accessibility';\nimport { isHTMLElement } from './dom';\n\nexport type ImgOnlyAttributes = {\n  [index in Exclude<\n    keyof React.ImgHTMLAttributes<HTMLImageElement>,\n    keyof React.HTMLAttributes<HTMLImageElement>\n  >]: React.ImgHTMLAttributes<HTMLImageElement>[index];\n};\n\nexport function setRef<T>(element: T, ref?: React.Ref<T>): void {\n  if (ref) {\n    if (typeof ref === 'function') {\n      ref(element);\n    } else {\n      (ref as React.MutableRefObject<T>).current = element;\n    }\n  }\n}\n\nexport function multiRef<T>(...refs: Array<React.Ref<T> | undefined>): React.RefObject<T> {\n  let current: T | null = null;\n  return {\n    get current() {\n      return current;\n    },\n    set current(element) {\n      current = element;\n      refs.forEach((ref) => ref && setRef(element, ref));\n    },\n  };\n}\n\nexport const stopPropagation = <T extends React.SyntheticEvent>(event: T): void =>\n  event.stopPropagation();\n\nexport function addClassNameToElement(element: HTMLElement, className: string): void {\n  const elementClassName = element.getAttribute('class') || '';\n  const updatedClassName = `${elementClassName}${elementClassName ? ' ' : ''}${className}`;\n\n  element.setAttribute('class', updatedClassName);\n}\n\nexport function removeClassNameFromElement(element: HTMLElement, classNameToRemove: string): void {\n  const classNamesArray = (element.getAttribute('class') || '').split(/\\s+/);\n  const elementIndexToRemove = classNamesArray.findIndex(\n    (className) => className === classNameToRemove,\n  );\n  if (elementIndexToRemove === -1) {\n    return;\n  }\n  classNamesArray.splice(elementIndexToRemove, 1);\n\n  element.setAttribute('class', classNamesArray.join(' '));\n}\n\ntype ExcludeKeysWithUndefined<T> = {\n  [P in keyof T]?: Exclude<T[P], undefined>;\n};\n\nexport const excludeKeysWithUndefined = <T extends Record<string | number | symbol, any>>(\n  obj: T,\n): ExcludeKeysWithUndefined<T> => {\n  const filteredObj: ExcludeKeysWithUndefined<T> = {};\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key) && obj[key] !== undefined) {\n      filteredObj[key] = obj[key];\n    }\n  }\n  return filteredObj;\n};\n\nexport const isDOMTypeElement = <\n  P extends React.HTMLAttributes<T> | React.SVGAttributes<T>,\n  T extends Element,\n>(\n  element: React.ReactElement,\n): element is Omit<React.DOMElement<P, T>, 'ref'> & { ref?: React.Ref<T> | undefined } =>\n  typeof element.type === 'string';\n\nexport function isValidNotReactFragmentElement(\n  children: Parameters<typeof React.isValidElement>[0],\n): children is React.ReactElement<Record<PropertyKey, any>> {\n  return (\n    React.isValidElement(children) &&\n    // @ts-expect-error: TS2339 $$typeof всегда symbol, в отличии от type, благодаря этому пропускаем лишние проверки на тип.\n    children.$$typeof !== Symbol.for('react.fragment')\n  );\n}\n\nexport function isForwardRefElement<\n  P extends React.HTMLAttributes<T> | React.SVGAttributes<T>,\n  T extends Element,\n>(\n  children: Parameters<typeof React.isValidElement>[0],\n): children is Omit<React.DOMElement<P, T>, 'ref'> & { ref?: React.Ref<T> | undefined } {\n  if (!React.isValidElement(children)) {\n    return false;\n  }\n\n  // @ts-expect-error: TS2339 $$typeof всегда symbol, в отличии от type, благодаря этому пропускаем лишние проверки на тип.\n  // черпаем вдохновение из react-is https://github.com/facebook/react/blob/d48dbb824985166ecb7b2959db03090a8593dce0/packages/react-is/src/ReactIs.js#L119-L121\n  const typeOfOfType = children.type && children.type.$$typeof;\n  return typeOfOfType === Symbol.for('react.forward_ref');\n}\n\n/**\n * При использовании пропа fetchPriority генерируется warning \"Invalid DOM property\" (версия React 18.*)\n * Ворнинга нет в React версии 19.*, поэтому пока поддерживаем 2 версии наименования\n */\nexport function getFetchPriorityProp(value: React.ImgHTMLAttributes<HTMLElement>['fetchPriority']):\n  | {\n      fetchPriority: 'high' | 'low' | 'auto' | undefined;\n    }\n  | {\n      fetchpriority: 'high' | 'low' | 'auto' | undefined;\n    } {\n  if (React.version.startsWith('19')) {\n    return { fetchPriority: value };\n  }\n  return { fetchpriority: value };\n}\n\n/*\n * [a11y]\n * Обрабатывает событие onkeydown\n * для кастомных доступных элементов:\n * - role=\"link\" (активация по Enter)\n * - role=\"button\" (активация по Space и Enter)\n */\nexport function clickByKeyboardHandler(event: React.KeyboardEvent<HTMLDivElement>): void {\n  if (!isHTMLElement(event.target) || !shouldTriggerClickOnEnterOrSpace(event)) {\n    return;\n  }\n\n  event.preventDefault();\n  event.target.click?.();\n}\n"],"names":["addClassNameToElement","clickByKeyboardHandler","excludeKeysWithUndefined","getFetchPriorityProp","isDOMTypeElement","isForwardRefElement","isValidNotReactFragmentElement","multiRef","removeClassNameFromElement","setRef","stopPropagation","element","ref","current","refs","forEach","event","className","elementClassName","getAttribute","updatedClassName","setAttribute","classNameToRemove","classNamesArray","split","elementIndexToRemove","findIndex","splice","join","obj","filteredObj","key","hasOwnProperty","undefined","type","children","React","isValidElement","$$typeof","Symbol","for","typeOfOfType","value","version","startsWith","fetchPriority","fetchpriority","isHTMLElement","target","shouldTriggerClickOnEnterOrSpace","preventDefault","click"],"mappings":"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"}