{"version":3,"sources":["../../../../src/components/CustomScrollView/useHorizontalScrollController.tsx"],"sourcesContent":["import * as React from 'react';\nimport type { CustomScrollBarController } from './types';\nimport { useTrackerVisibility } from './useTrackerVisibility';\n\nexport const useHorizontalScrollController = (\n  boxRef: React.RefObject<HTMLDivElement | null>,\n  autoHideScrollbar: boolean,\n  autoHideScrollbarDelay?: number,\n): CustomScrollBarController => {\n  const barX = React.useRef<HTMLDivElement>(null);\n\n  const horizontalRatio = React.useRef(NaN);\n  const lastTrackerLeft = React.useRef(0);\n  const clientWidth = React.useRef(0);\n  const trackerWidth = React.useRef(0);\n  const scrollWidth = React.useRef(0);\n  const startX = React.useRef(0);\n  const trackerLeft = React.useRef(0);\n\n  const trackerX = React.useRef<HTMLDivElement>(null);\n\n  const {\n    trackerVisible,\n    onTargetScroll,\n    onTrackerDragStart,\n    onTrackerDragStop,\n    onTrackerMouseEnter,\n    onTrackerMouseLeave,\n  } = useTrackerVisibility(autoHideScrollbar, autoHideScrollbarDelay);\n\n  const setHorizontalTrackerPosition = (scrollLeft: number) => {\n    lastTrackerLeft.current = scrollLeft;\n    if (trackerX.current !== null) {\n      trackerX.current.style.transform = `translate(${scrollLeft}px, 0)`;\n    }\n  };\n\n  const setTrackerPositionFromScroll = (scrollLeft: number) => {\n    const progress = scrollLeft / (scrollWidth.current - clientWidth.current);\n    setHorizontalTrackerPosition((clientWidth.current - trackerWidth.current) * progress);\n  };\n\n  const resize = () => {\n    if (!boxRef.current || !barX.current || !trackerX.current) {\n      return;\n    }\n    const localClientWidth = boxRef.current.clientWidth;\n    const localScrollWidth = boxRef.current.scrollWidth;\n    const localVerticalRatio = localClientWidth / localScrollWidth;\n    const localTrackerWidth = Math.max(localClientWidth * localVerticalRatio, 40);\n\n    horizontalRatio.current = localVerticalRatio;\n    clientWidth.current = localClientWidth;\n    scrollWidth.current = localScrollWidth;\n    trackerWidth.current = localTrackerWidth;\n    const currentScrollLeft = boxRef.current.scrollLeft;\n\n    if (localVerticalRatio >= 1) {\n      barX.current.style.display = 'none';\n    } else {\n      barX.current.style.display = '';\n      trackerX.current.style.width = `${localTrackerWidth}px`;\n      setTrackerPositionFromScroll(currentScrollLeft);\n    }\n  };\n\n  const setScrollPositionFromTracker = (trackerLeft: number) => {\n    const progress = trackerLeft / (clientWidth.current - trackerWidth.current);\n    if (boxRef.current !== null) {\n      boxRef.current.scroll({\n        left: (scrollWidth.current - clientWidth.current) * progress,\n      });\n    }\n  };\n\n  const dragging = (e: React.MouseEvent) => {\n    const diff = e.clientX - startX.current;\n    const position = Math.min(\n      Math.max(trackerLeft.current + diff, 0),\n      clientWidth.current - trackerWidth.current,\n    );\n    setScrollPositionFromTracker(position);\n  };\n\n  const dragEnd = () => {\n    if (autoHideScrollbar) {\n      onTrackerDragStop();\n    }\n  };\n\n  const scroll = () => {\n    if (!boxRef.current) {\n      return;\n    }\n    if (autoHideScrollbar) {\n      onTargetScroll();\n    }\n    setTrackerPositionFromScroll(boxRef.current.scrollLeft);\n  };\n\n  const dragStart = (e: React.MouseEvent) => {\n    startX.current = e.clientX;\n    trackerLeft.current = lastTrackerLeft.current;\n\n    if (autoHideScrollbar) {\n      onTrackerDragStart();\n    }\n  };\n\n  return {\n    barRef: barX,\n    trackerVisible,\n    trackerRef: trackerX,\n    resize,\n    dragging,\n    dragEnd,\n    scroll,\n    dragStart,\n    trackerMouseEnter: onTrackerMouseEnter,\n    trackerMouseLeave: onTrackerMouseLeave,\n  };\n};\n"],"names":["React","useTrackerVisibility","useHorizontalScrollController","boxRef","autoHideScrollbar","autoHideScrollbarDelay","barX","useRef","horizontalRatio","NaN","lastTrackerLeft","clientWidth","trackerWidth","scrollWidth","startX","trackerLeft","trackerX","trackerVisible","onTargetScroll","onTrackerDragStart","onTrackerDragStop","onTrackerMouseEnter","onTrackerMouseLeave","setHorizontalTrackerPosition","scrollLeft","current","style","transform","setTrackerPositionFromScroll","progress","resize","localClientWidth","localScrollWidth","localVerticalRatio","localTrackerWidth","Math","max","currentScrollLeft","display","width","setScrollPositionFromTracker","scroll","left","dragging","e","diff","clientX","position","min","dragEnd","dragStart","barRef","trackerRef","trackerMouseEnter","trackerMouseLeave"],"mappings":"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"}